$engine: 3
$onesync: on
name: "RP Sérieux FR (FULL CLEAN V8) — GitHub Remote"
version: "8.0.0-fr-remote"
author: "txAdmin Recipe Pack"
description: "Remote recipe: txAdmin télécharge d'abord TON repo (recipe_files) puis installe QBCore + deps. Corrige l'erreur recipe_files/server.cfg introuvable en remote."

# ⚠️ IMPORTANT
# - Mets TON repo GitHub en PUBLIC
# - Dans TON repo, il doit y avoir à la racine:
#     - recipe_files/ (avec server.cfg + configs + ressources custom)
# - Modifie ci-dessous 'src:' pour pointer vers ton repo GitHub

vars:
  CUSTOM_REPO: "https://github.com/Vincx12/gta.git"   # <-- CHANGE ICI si ton repo a un autre nom
  CUSTOM_REF: "main"

tasks:
  # 0) Télécharge TON repo (recipe_files)
  - action: download_github
    src: "https://github.com/Vincx12/gta.git"
    ref: "{{CUSTOM_REF}}"
    dest: ./tmp/custom

  # 1) Base QBCore txAdmin recipe (SQL + logo)
  - action: download_github
    src: https://github.com/qbcore-framework/txAdminRecipe
    ref: main
    dest: ./tmp/qbcore

  # 2) server.cfg depuis TON repo
  - action: move_path
    src: ./tmp/custom/recipe_files/server.cfg
    dest: ./server.cfg

  - action: move_path
    src: ./tmp/qbcore/myLogo.png
    dest: ./myLogo.png

  # 3) DB
  - action: connect_database
  - action: query_database
    file: ./tmp/qbcore/qbcore.sql

  # 4) Default CFX resources
  - action: download_github
    src: https://github.com/citizenfx/cfx-server-data
    subpath: resources
    dest: ./resources/[cfx-default]
  - action: remove_path
    path: ./resources/[cfx-default]/[gameplay]/chat

  # 5) oxmysql
  - action: download_file
    path: ./tmp/files/oxmysql.zip
    url: https://github.com/overextended/oxmysql/releases/download/v2.12.0/oxmysql.zip
  - action: unzip
    dest: ./resources/[standalone]
    src: ./tmp/files/oxmysql.zip

  # 6) Standalone deps
  - action: download_github
    dest: ./resources/[standalone]/progressbar
    ref: main
    src: https://github.com/qbcore-framework/progressbar
  - action: download_github
    dest: ./resources/[standalone]/interact-sound
    ref: master
    src: https://github.com/qbcore-framework/interact-sound
  - action: download_github
    dest: ./resources/[standalone]/PolyZone
    ref: master
    src: https://github.com/qbcore-framework/PolyZone

  # 7) Voice + map
  - action: download_github
    dest: ./resources/[voice]/pma-voice
    ref: main
    src: https://github.com/AvarianKnight/pma-voice
  - action: download_github
    dest: ./resources/[defaultmaps]/hospital_map
    ref: main
    src: https://github.com/qbcore-framework/hospital_map

  # 8) QBCore core + UI deps + target
  - action: download_github
    dest: ./resources/[qb]/qb-core
    ref: main
    src: https://github.com/qbcore-framework/qb-core
  - action: download_github
    dest: ./resources/[qb]/qb-menu
    ref: main
    src: https://github.com/qbcore-framework/qb-menu
  - action: download_github
    dest: ./resources/[qb]/qb-input
    ref: main
    src: https://github.com/qbcore-framework/qb-input
  - action: download_github
    dest: ./resources/[qb]/qb-target
    ref: main
    src: https://github.com/qbcore-framework/qb-target

  # 9) Essentials
  - action: download_github
    dest: ./resources/[qb]/qb-management
    ref: main
    src: https://github.com/qbcore-framework/qb-management
  - action: download_github
    dest: ./resources/[qb]/qb-cityhall
    ref: main
    src: https://github.com/qbcore-framework/qb-cityhall
  - action: download_github
    dest: ./resources/[qb]/qb-shops
    ref: main
    src: https://github.com/qbcore-framework/qb-shops
  - action: download_github
    dest: ./resources/[qb]/qb-fuel
    ref: main
    src: https://github.com/qbcore-framework/qb-fuel
  - action: download_github
    dest: ./resources/[qb]/qb-banking
    ref: main
    src: https://github.com/qbcore-framework/qb-banking

  # 10) Jobs
  - action: download_github
    dest: ./resources/[qb]/qb-policejob
    ref: main
    src: https://github.com/qbcore-framework/qb-policejob
  - action: download_github
    dest: ./resources/[qb]/qb-ambulancejob
    ref: main
    src: https://github.com/qbcore-framework/qb-ambulancejob
  - action: download_github
    dest: ./resources/[qb]/qb-mechanicjob
    ref: main
    src: https://github.com/qbcore-framework/qb-mechanicjob
  - action: download_github
    dest: ./resources/[qb]/qb-vehicleshop
    ref: main
    src: https://github.com/qbcore-framework/qb-vehicleshop
  - action: download_github
    dest: ./resources/[qb]/qb-vehiclesales
    ref: main
    src: https://github.com/qbcore-framework/qb-vehiclesales
  - action: download_github
    dest: ./resources/[qb]/qb-lawyerjob
    ref: main
    src: https://github.com/viruspc2002/qb-lawyerjob

  # 11) Extras
  - action: download_github
    dest: ./resources/[qb]/qb-customs
    ref: main
    src: https://github.com/xenfovn/qb-customs-2
  - action: download_github
    dest: ./resources/[qb]/qb-speedcameras
    ref: main
    src: https://github.com/tom-osborne/qb-speedcameras
  - action: download_github
    dest: ./resources/[qb]/qb-sna-billing
    ref: main
    src: https://github.com/Sna-aaa/qb-sna-billing

  # 12) Appliquer TES configs (depuis TON repo)
  - action: move_path
    src: ./tmp/custom/recipe_files/qbcore_config.lua
    dest: ./resources/[qb]/qb-core/config.lua
    overwrite: true
  - action: move_path
    src: ./tmp/custom/recipe_files/qbcore_jobs.lua
    dest: ./resources/[qb]/qb-core/shared/jobs.lua
    overwrite: true
  - action: move_path
    src: ./tmp/custom/recipe_files/qb_shops_config.lua
    dest: ./resources/[qb]/qb-shops/config.lua
    overwrite: true
  - action: move_path
    src: ./tmp/custom/recipe_files/qb_fuel_config.lua
    dest: ./resources/[qb]/qb-fuel/config.lua
    overwrite: true
  - action: move_path
    src: ./tmp/custom/recipe_files/qb_ambulance_config.lua
    dest: ./resources/[qb]/qb-ambulancejob/config.lua
    overwrite: true
  - action: move_path
    src: ./tmp/custom/recipe_files/qb_police_config.lua
    dest: ./resources/[qb]/qb-policejob/config.lua
    overwrite: true
  - action: move_path
    src: ./tmp/custom/recipe_files/qb_vehicleshop_config.lua
    dest: ./resources/[qb]/qb-vehicleshop/config.lua
    overwrite: true
  - action: move_path
    src: ./tmp/custom/recipe_files/qb_speedcameras_config.lua
    dest: ./resources/[qb]/qb-speedcameras/config.lua
    overwrite: true
  - action: move_path
    src: ./tmp/custom/recipe_files/qb_sna_billing_config.lua
    dest: ./resources/[qb]/qb-sna-billing/config.lua
    overwrite: true

  # 13) Ajouter TES ressources custom
  - action: copy_path
    src: ./tmp/custom/recipe_files/qb-prefet
    dest: ./resources/[qb]/qb-prefet
  - action: copy_path
    src: ./tmp/custom/recipe_files/qb-tribunal-basic
    dest: ./resources/[qb]/qb-tribunal-basic
  - action: copy_path
    src: ./tmp/custom/recipe_files/ultra_realism
    dest: ./resources/[standalone]/ultra_realism

  - action: remove_path
    path: ./tmp
